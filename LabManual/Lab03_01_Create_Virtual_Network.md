---
lab:
    title: '仮想ネットワークの作成'
    learning path: '03'
    module: 'Module2 Azureのコアサービス'
---
# ラボ 03: 仮想ネットワークの作成

## ラボ シナリオ

あなたの会社では仮想ネットワークを作成し、その仮想ネットワークに 2 台の仮想マシンをデプロイして、仮想ネットワーク経由で一方の仮想マシンから他方の仮想マシンに ping を実行できるように構成します。



#### 推定時間: 40 分

### タスク 1 - 仮想ネットワークを作成する

1. Azure portal　([https://portal.azure.com](https://portal.azure.com))にサインインします。

2. Azure portalで「**仮想ネットワーク**」を検索して選択し、「**+ 作成**」をクリックします。 

3. 「**基本**」タブで、次の情報を入力し、「次へ」をクリックします (その他の情報は既定値のままにします)。

   | 設定               | 値                                            |
   | ------------------ | --------------------------------------------- |
   | サブスクリプション | **Microsoft Azure スポンサー プラン**         |
   | リソース グループ  | **AzureStudent1##**                           |
   | 仮想ネットワーク名 | **vnet##a**                                   |
   | 地域               | **(Asia Pacific) Japan East もしくは 東日本** |

   ![lab3-01](./media/lab3-01.BMP)

4. 「**セキュリティ**」タブは、何も変更せずに**「次へ」**をクリックします。

5. 「**IPアドレス**」タブは、サブネットの**「default」**をクリックし、次の情報を入力し、**「次へ」**をクリックします (その他の情報は既定値のままにします)。

   | 設定         | 値       |
   | ------------ | -------- |
   | 名前         | Subnet1  |
   | 開始アドレス | 10.0.1.0 |

   ![lab3-02](./media/lab3-02.BMP)

6. **「レビューと作成」**  をクリックして、さらに **「作成」** をクリックします。



### タスク 2 - 1台目の仮想マシンを作成する

1. Azure portalで「**Virtual Machines**」を検索して選択し、「**+作成**」をクリックしてプルダウンから「**Azure仮想マシン**」を選択します。 

2. 「仮想マシンの作成」ブレードの「**基本**」タブで、次の情報を入力します (特に指示がない項目は、既定値のままにします)。

   | 設定                      | 値                                                           |
   | ------------------------- | ------------------------------------------------------------ |
   | サブスクリプション        | **Microsoft Azure スポンサー プラン**                        |
   | リソース グループ         | **AzureStudent1##**                                          |
   | 仮想マシン名              | **az900-##-vm1**                                             |
   | 地域                      | **(Asia Pacific) Japan East もしくは 東日本**                |
   | 可用性オプション          | **インフラストラクチャ冗長は必要ありません**                 |
   | イメージ                  | **Windows Server 2022 Datacenter: Azure Edition - x64 Gen2** |
   | Azure Spot 割引で実行する | **チェックなし**                                             |
   | サイズ                    | **Standard_DS1_V2**                                          |
   | ユーザー名                | **admsv**                                                    |
   | パスワード                | **Pa55w.rdabc1234**                                          |
   | パブリック受信ポート      | **選択したポートを許可する**                                 |
   | 受信ポートを選択          | **RDP (3389)**                                               |

   

3. **「次：ディスク >」** をクリックし、**「ディスクのオプション」**で以下の選択してください。指定した箇所以外は変更しません。

   | 設定             | 値                                       |
   | ---------------- | ---------------------------------------- |
   | OSディスクの種類 | **Standard SSD(ローカル冗長ストレージ)** |

4. **「次：ネットワーク >」** をクリックします。

5. 「**ネットワーク**」タブでは、仮想ネットワークに**「vnet##a」**を選択してください。指定した箇所以外は変更しません。

6. **「確認および作成」**  をクリックして、さらに **「作成」** をクリックします。

7. 仮想マシンのデプロイ完了を待たずに次のタスクに進みます。



### タスク 2 - 2台目の仮想マシンを作成する

1. Azure portalで「**Virtual Machines**」を検索して選択し、「**+作成**」をクリックしてプルダウンから「**Azure仮想マシン**」を選択します。 

2. 「仮想マシンの作成」ブレードの「**基本**」タブで、次の情報を入力します (特に指示がない項目は、既定値のままにします)。

   | 設定                      | 値                                                           |
   | ------------------------- | ------------------------------------------------------------ |
   | サブスクリプション        | **Microsoft Azure スポンサー プラン**                        |
   | リソース グループ         | **AzureStudent1##**                                          |
   | 仮想マシン名              | **az900-##-vm2**                                             |
   | 地域                      | **(Asia Pacific) Japan East もしくは 東日本**                |
   | 可用性オプション          | **インフラストラクチャ冗長は必要ありません**                 |
   | イメージ                  | **Windows Server 2022 Datacenter: Azure Edition - x64 Gen2** |
   | Azure Spot 割引で実行する | **チェックなし**                                             |
   | サイズ                    | **Standard_DS1_V2**                                          |
   | ユーザー名                | **admsv**                                                    |
   | パスワード                | **Pa55w.rdabc1234**                                          |
   | パブリック受信ポート      | **選択したポートを許可する**                                 |
   | 受信ポートを選択          | **RDP (3389)**                                               |

   

3. **「次：ディスク >」** をクリックし、**「ディスクのオプション」**で以下の選択してください。指定した箇所以外は変更しません。

   | 設定             | 値                                       |
   | ---------------- | ---------------------------------------- |
   | OSディスクの種類 | **Standard SSD(ローカル冗長ストレージ)** |

4. **「次：ネットワーク >」** をクリックします。

5. 「**ネットワーク**」タブでは、仮想ネットワークに**「vnet##a」**を選択してください。指定した箇所以外は変更しません。

6. **「確認および作成」**  をクリックして、さらに **「作成」** をクリックします。

7. 仮想マシンのデプロイ完了を待たずに次のタスクに進みます。



### タスク 3 - 作成した仮想マシンを確認する

1. Azure portalで「**Virtual Machines**」を検索して選択し、両方の仮想マシンがデプロイされ、「**状態**」が「**実行中**」と表示されるのを待ちます。

   > 表示されない場合はWebブラウザの再読み込みを何回か行ってください。
   
   ![lab3-03](./media/lab3-03.BMP)
   
   

### タスク 4 - 作成した仮想マシン間の通信を確認する

1. 「**Virtual Machines**」 ブレードで**az900-##-vm1** をクリックします。

2. 「**ネイティブRDP**」の項目で「**選択**」のボタンをクリックし、表示されたメニューから「**RDP ファイルのダウンロード**」をクリックしてください。

3. ダウンロードした RDP ファイルをクリックし、Windows 認証を行いサインインしてください。
   ※証明書に関する警告が表示された場合は「はい」をクリックしてください

   | **設定**   | **値**              |
   | :--------- | :------------------ |
   | ユーザー名 | **admsv**           |
   | パスワード | **Pa55w.rdabc1234** |

   
   
5. RDP接続先のマシンにて、スタートメニューから「**Powershell**」を起動します。

   ![AZ900_Lab1_20](./media/AZ900_Lab1_20.png)

   

6. 起動した Powershell で以下のコマンドを実行してください。

   ```powershell
   Test-NetConnection 10.0.1.5 -Port 3389
   ```

   > 注：これはIIS をインストールするコマンドです。

   

7. 以下の値が返ってくれば成功です。

   ```powershell
   TcpTestSucceeded : True
   ```



これで仮想ネットワークの構築、仮想マシンの構築、仮想マシン間の通信を確認できました。

演習は終了です。お疲れ様でした。

